/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package UI;

import java.sql.*;
import DAO.HoaDonDAO;
import DAO.KhachHangDAO;
import DAO.NhanVienDAO;
import DAO.SanPhamDAO;
import Entity.HoaDon;
import Entity.KhachHang;
import Entity.SanPham;
import Ultils.Auth;
import Ultils.MsgBox;
import Ultils.XDate;
import Ultils.XImage;
import Ultils.XJdbc;
import Ultils.dateHelper;
import Ultils.utilityHelper;
import static java.awt.Color.pink;
import static java.awt.Color.white;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseEvent;

import java.io.BufferedOutputStream;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.sql.DriverManager;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.DefaultComboBoxModel;
import javax.swing.JFileChooser;
import javax.swing.JInternalFrame;
import javax.swing.JOptionPane;
import javax.swing.JTextField;
import javax.swing.Timer;
import javax.swing.filechooser.FileNameExtensionFilter;
import javax.swing.table.DefaultTableModel;
import static org.apache.poi.hssf.usermodel.HeaderFooter.date;
import org.apache.poi.xssf.usermodel.XSSFCell;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

/**
 *
 * @author nolan
 */
public class FormChinh extends javax.swing.JFrame {

    /**
     * Creates new form FormChinh
     */
    public FormChinh() {
        initComponents();
        init();
        loadKhachHang();
        loadSanPham();
        loadhd();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")

    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        buttonGroup2 = new javax.swing.ButtonGroup();
        jPanel2 = new javax.swing.JPanel();
        TabsALL = new javax.swing.JTabbedPane();
        TabsQuanLiCuaHang = new javax.swing.JTabbedPane();
        TabTrangChu = new javax.swing.JPanel();
        lblDongHo = new javax.swing.JLabel();
        lblday = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        TabSanPham = new javax.swing.JTabbedPane();
        CapNhapSP = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        txtMaSP1 = new javax.swing.JTextField();
        txtNhanHieuSP = new javax.swing.JTextField();
        txtTenSP = new javax.swing.JTextField();
        txtMauSP = new javax.swing.JTextField();
        cbbSize = new javax.swing.JComboBox();
        txtSoLuongSP = new javax.swing.JTextField();
        txtGiaSP = new javax.swing.JTextField();
        jLabel27 = new javax.swing.JLabel();
        jLabel15 = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();
        jLabel29 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        jLabel28 = new javax.swing.JLabel();
        lblHinh = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        btnThemSP = new javax.swing.JButton();
        btnXoaSP = new javax.swing.JButton();
        btnMoiSP = new javax.swing.JButton();
        btnSuaSP = new javax.swing.JButton();
        jPanel5 = new javax.swing.JPanel();
        btnFirtSP = new javax.swing.JButton();
        btnPreSP = new javax.swing.JButton();
        btnNexSP = new javax.swing.JButton();
        btnLasSP = new javax.swing.JButton();
        DanhSachSP = new javax.swing.JPanel();
        jLabel7 = new javax.swing.JLabel();
        txtTimkiemSP = new javax.swing.JTextField();
        jScrollPane2 = new javax.swing.JScrollPane();
        tblSP = new javax.swing.JTable();
        btnXuatSP = new javax.swing.JButton();
        TabHoaDon = new javax.swing.JTabbedPane();
        CapNhapHD = new javax.swing.JPanel();
        jPanel6 = new javax.swing.JPanel();
        txtmahd = new javax.swing.JTextField();
        cboMaSP = new javax.swing.JComboBox();
        cboMaKH = new javax.swing.JComboBox();
        txttrangthai = new javax.swing.JTextField();
        txtNgayLapHD = new javax.swing.JTextField();
        txtSoLuongHD = new javax.swing.JTextField();
        txtthanhtien = new javax.swing.JTextField();
        txtmanv_HD = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        jLabel25 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        jLabel13 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        jLabel26 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jLabel24 = new javax.swing.JLabel();
        jPanel7 = new javax.swing.JPanel();
        btnthemHD = new javax.swing.JButton();
        btnxoahd = new javax.swing.JButton();
        btnsuahd = new javax.swing.JButton();
        btnMoiHD = new javax.swing.JButton();
        jPanel8 = new javax.swing.JPanel();
        btndauhd = new javax.swing.JButton();
        btncuoihd = new javax.swing.JButton();
        btnluihd = new javax.swing.JButton();
        btntoihd = new javax.swing.JButton();
        DanhSachHD = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        tblHd = new javax.swing.JTable();
        jLabel8 = new javax.swing.JLabel();
        txtTimKiemHD = new javax.swing.JTextField();
        btnXuatHD = new javax.swing.JButton();
        TabKhachHang = new javax.swing.JTabbedPane();
        CapNhapKH = new javax.swing.JPanel();
        jPanel9 = new javax.swing.JPanel();
        jLabel19 = new javax.swing.JLabel();
        txtMaKH = new javax.swing.JTextField();
        jLabel20 = new javax.swing.JLabel();
        txtTenKH = new javax.swing.JTextField();
        jLabel21 = new javax.swing.JLabel();
        txtSdt_KH = new javax.swing.JTextField();
        jLabel22 = new javax.swing.JLabel();
        txtDiachi_KH = new javax.swing.JTextField();
        jLabel23 = new javax.swing.JLabel();
        txtEmail_KH = new javax.swing.JTextField();
        jPanel10 = new javax.swing.JPanel();
        btnThemKH = new javax.swing.JButton();
        btnXoaKH = new javax.swing.JButton();
        btnSuaKH = new javax.swing.JButton();
        btnMoiKH = new javax.swing.JButton();
        jPanel11 = new javax.swing.JPanel();
        btnLast = new javax.swing.JButton();
        btnPrev = new javax.swing.JButton();
        btnFirst = new javax.swing.JButton();
        btnNext = new javax.swing.JButton();
        DanhSachKH = new javax.swing.JPanel();
        jLabel14 = new javax.swing.JLabel();
        txtTimkiemKH = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblKh = new javax.swing.JTable();
        btnXuatKH = new javax.swing.JButton();
        TabDoiMatKhau = new javax.swing.JPanel();
        jPanel12 = new javax.swing.JPanel();
        jLabel3 = new javax.swing.JLabel();
        txttennv = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        txtmatkhau = new javax.swing.JPasswordField();
        jLabel5 = new javax.swing.JLabel();
        txtmatkhaumoi = new javax.swing.JPasswordField();
        jLabel6 = new javax.swing.JLabel();
        txtnhaplaimatkhau = new javax.swing.JPasswordField();
        jPanel13 = new javax.swing.JPanel();
        btndongy = new javax.swing.JButton();
        btnMoi = new javax.swing.JButton();
        TabQuanLy = new javax.swing.JTabbedPane();
        jPanel4 = new javax.swing.JPanel();
        jPanel14 = new javax.swing.JPanel();
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        btnDangXuat = new javax.swing.JButton();

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 100, Short.MAX_VALUE)
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 100, Short.MAX_VALUE)
        );

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        TabsALL.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N

        TabsQuanLiCuaHang.setTabPlacement(javax.swing.JTabbedPane.LEFT);
        TabsQuanLiCuaHang.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        TabsQuanLiCuaHang.setMaximumSize(new java.awt.Dimension(40000, 40000));
        TabsQuanLiCuaHang.addAncestorListener(new javax.swing.event.AncestorListener() {
            public void ancestorMoved(javax.swing.event.AncestorEvent evt) {
            }
            public void ancestorAdded(javax.swing.event.AncestorEvent evt) {
                TabsQuanLiCuaHangAncestorAdded(evt);
            }
            public void ancestorRemoved(javax.swing.event.AncestorEvent evt) {
            }
        });

        lblDongHo.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        lblDongHo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Alarm.png"))); // NOI18N
        lblDongHo.setText("12:00 AM");

        lblday.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        lblday.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/lich.png"))); // NOI18N
        lblday.setText("DAYS");

        jLabel1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/shop.jpg"))); // NOI18N

        javax.swing.GroupLayout TabTrangChuLayout = new javax.swing.GroupLayout(TabTrangChu);
        TabTrangChu.setLayout(TabTrangChuLayout);
        TabTrangChuLayout.setHorizontalGroup(
            TabTrangChuLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(TabTrangChuLayout.createSequentialGroup()
                .addGroup(TabTrangChuLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(TabTrangChuLayout.createSequentialGroup()
                        .addGap(760, 760, 760)
                        .addComponent(lblday, javax.swing.GroupLayout.PREFERRED_SIZE, 180, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(TabTrangChuLayout.createSequentialGroup()
                        .addGap(750, 750, 750)
                        .addComponent(lblDongHo, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(TabTrangChuLayout.createSequentialGroup()
                .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                .addContainerGap())
        );
        TabTrangChuLayout.setVerticalGroup(
            TabTrangChuLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(TabTrangChuLayout.createSequentialGroup()
                .addGap(6, 6, 6)
                .addComponent(lblday, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(4, 4, 4)
                .addComponent(lblDongHo, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addComponent(jLabel1)
        );

        TabsQuanLiCuaHang.addTab("  TRANG CHỦ", new javax.swing.ImageIcon(getClass().getResource("/Icon/sanpham.png")), TabTrangChu); // NOI18N

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)), "Cập Nhật", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 13))); // NOI18N

        txtMaSP1.setName("Mã sản phẩm"); // NOI18N

        txtNhanHieuSP.setName("Nhãn hiệu"); // NOI18N

        txtTenSP.setName("Tên sản phẩm"); // NOI18N

        txtMauSP.setName("Màu"); // NOI18N
        txtMauSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtMauSPActionPerformed(evt);
            }
        });

        cbbSize.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "S", "M", "L", "XL" }));

        txtSoLuongSP.setName("Số lượng"); // NOI18N

        txtGiaSP.setName("Giá Ttền"); // NOI18N
        txtGiaSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtGiaSPActionPerformed(evt);
            }
        });

        jLabel27.setText("Mã SP :");

        jLabel15.setText("Nhãn Hiệu :");

        jLabel17.setText("Tên :");

        jLabel29.setText("Màu :");

        jLabel16.setText("Size :");

        jLabel18.setText("Số Lượng :");

        jLabel28.setText("Giá tiền :");

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel27, javax.swing.GroupLayout.PREFERRED_SIZE, 49, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel17)
                    .addComponent(jLabel29)
                    .addComponent(jLabel28)
                    .addComponent(jLabel16)
                    .addComponent(jLabel18)
                    .addComponent(jLabel15))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txtGiaSP, javax.swing.GroupLayout.DEFAULT_SIZE, 442, Short.MAX_VALUE)
                    .addComponent(txtSoLuongSP)
                    .addComponent(cbbSize, javax.swing.GroupLayout.PREFERRED_SIZE, 109, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtNhanHieuSP)
                    .addComponent(txtMaSP1, javax.swing.GroupLayout.PREFERRED_SIZE, 440, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtTenSP)
                    .addComponent(txtMauSP))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtMaSP1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel27))
                .addGap(39, 39, 39)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel15)
                    .addComponent(txtNhanHieuSP, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(38, 38, 38)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtTenSP, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel17))
                .addGap(38, 38, 38)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(txtMauSP, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel29))
                .addGap(38, 38, 38)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel16)
                    .addComponent(cbbSize, javax.swing.GroupLayout.PREFERRED_SIZE, 32, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(38, 38, 38)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtSoLuongSP, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel18))
                .addGap(39, 39, 39)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtGiaSP, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel28))
                .addContainerGap(41, Short.MAX_VALUE))
        );

        lblHinh.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblHinh.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        lblHinh.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                lblHinhMouseClicked(evt);
            }
        });

        jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)), "Chức Năng", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 13))); // NOI18N

        btnThemSP.setBackground(new java.awt.Color(255, 255, 255));
        btnThemSP.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Add.png"))); // NOI18N
        btnThemSP.setText("Thêm");
        btnThemSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThemSPActionPerformed(evt);
            }
        });

        btnXoaSP.setBackground(new java.awt.Color(255, 255, 255));
        btnXoaSP.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Delete.png"))); // NOI18N
        btnXoaSP.setText("Xóa");
        btnXoaSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXoaSPActionPerformed(evt);
            }
        });

        btnMoiSP.setBackground(new java.awt.Color(255, 255, 255));
        btnMoiSP.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/New.png"))); // NOI18N
        btnMoiSP.setText("Mới");
        btnMoiSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnMoiSPActionPerformed(evt);
            }
        });

        btnSuaSP.setBackground(new java.awt.Color(255, 255, 255));
        btnSuaSP.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Update.png"))); // NOI18N
        btnSuaSP.setText("Cập nhật");
        btnSuaSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSuaSPActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(btnSuaSP)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(btnMoiSP, javax.swing.GroupLayout.PREFERRED_SIZE, 111, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(btnThemSP, javax.swing.GroupLayout.PREFERRED_SIZE, 111, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(77, 77, 77)
                        .addComponent(btnXoaSP, javax.swing.GroupLayout.PREFERRED_SIZE, 111, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel3Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnMoiSP, btnSuaSP, btnThemSP, btnXoaSP});

        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnThemSP)
                    .addComponent(btnXoaSP))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 34, Short.MAX_VALUE)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnSuaSP)
                    .addComponent(btnMoiSP)))
        );

        jPanel5.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)), "Phím Tắt", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 13))); // NOI18N

        btnFirtSP.setBackground(new java.awt.Color(255, 255, 255));
        btnFirtSP.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/First.png"))); // NOI18N
        btnFirtSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnFirtSPActionPerformed(evt);
            }
        });

        btnPreSP.setBackground(new java.awt.Color(255, 255, 255));
        btnPreSP.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Previous.png"))); // NOI18N
        btnPreSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnPreSPActionPerformed(evt);
            }
        });

        btnNexSP.setBackground(new java.awt.Color(255, 255, 255));
        btnNexSP.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Next.png"))); // NOI18N
        btnNexSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNexSPActionPerformed(evt);
            }
        });

        btnLasSP.setBackground(new java.awt.Color(255, 255, 255));
        btnLasSP.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Last.png"))); // NOI18N
        btnLasSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLasSPActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addComponent(btnFirtSP)
                .addGap(18, 18, 18)
                .addComponent(btnPreSP)
                .addGap(33, 33, 33)
                .addComponent(btnNexSP)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 24, Short.MAX_VALUE)
                .addComponent(btnLasSP))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGap(29, 29, 29)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(btnLasSP)
                    .addComponent(btnFirtSP)
                    .addComponent(btnPreSP)
                    .addComponent(btnNexSP))
                .addContainerGap(31, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout CapNhapSPLayout = new javax.swing.GroupLayout(CapNhapSP);
        CapNhapSP.setLayout(CapNhapSPLayout);
        CapNhapSPLayout.setHorizontalGroup(
            CapNhapSPLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(CapNhapSPLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(18, 18, 18)
                .addGroup(CapNhapSPLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, CapNhapSPLayout.createSequentialGroup()
                        .addGroup(CapNhapSPLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(26, 26, 26))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, CapNhapSPLayout.createSequentialGroup()
                        .addComponent(lblHinh, javax.swing.GroupLayout.PREFERRED_SIZE, 198, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(83, 83, 83))))
        );
        CapNhapSPLayout.setVerticalGroup(
            CapNhapSPLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(CapNhapSPLayout.createSequentialGroup()
                .addGroup(CapNhapSPLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(CapNhapSPLayout.createSequentialGroup()
                        .addGap(19, 19, 19)
                        .addComponent(lblHinh, javax.swing.GroupLayout.PREFERRED_SIZE, 204, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(26, 26, 26)
                        .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(CapNhapSPLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(47, Short.MAX_VALUE))
        );

        TabSanPham.addTab("Quản lý", CapNhapSP);

        jLabel7.setText("Tìm kiếm");

        txtTimkiemSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtTimkiemSPActionPerformed(evt);
            }
        });
        txtTimkiemSP.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtTimkiemSPKeyReleased(evt);
            }
        });

        tblSP.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null}
            },
            new String [] {
                "Mã SP", "Nhãn Hiệu", "Tên ", "Màu", "Size", "Số Lượng", "Giá Tiền", "Hình"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, true
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblSP.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblSPMouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(tblSP);

        btnXuatSP.setBackground(new java.awt.Color(255, 255, 255));
        btnXuatSP.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Aprint.png"))); // NOI18N
        btnXuatSP.setText("Xuất File Excel");
        btnXuatSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXuatSPActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout DanhSachSPLayout = new javax.swing.GroupLayout(DanhSachSP);
        DanhSachSP.setLayout(DanhSachSPLayout);
        DanhSachSPLayout.setHorizontalGroup(
            DanhSachSPLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DanhSachSPLayout.createSequentialGroup()
                .addGap(29, 29, 29)
                .addGroup(DanhSachSPLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane2)
                    .addGroup(DanhSachSPLayout.createSequentialGroup()
                        .addComponent(jLabel7)
                        .addGap(18, 18, 18)
                        .addComponent(txtTimkiemSP, javax.swing.GroupLayout.PREFERRED_SIZE, 674, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 65, Short.MAX_VALUE)
                        .addComponent(btnXuatSP)))
                .addContainerGap())
        );
        DanhSachSPLayout.setVerticalGroup(
            DanhSachSPLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DanhSachSPLayout.createSequentialGroup()
                .addGap(28, 28, 28)
                .addGroup(DanhSachSPLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel7)
                    .addComponent(txtTimkiemSP, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnXuatSP))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 364, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(101, Short.MAX_VALUE))
        );

        TabSanPham.addTab("Danh Sách", DanhSachSP);

        TabsQuanLiCuaHang.addTab("  QUẢN LÝ SẢN PHẨM", new javax.swing.ImageIcon(getClass().getResource("/Icon/quanly.png")), TabSanPham); // NOI18N

        jPanel6.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)), "Cập Nhật", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 13))); // NOI18N

        txtmahd.setName("Mã hóa đơn"); // NOI18N

        cboMaSP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cboMaSPActionPerformed(evt);
            }
        });

        cboMaKH.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cboMaKHActionPerformed(evt);
            }
        });

        txttrangthai.setName("Trạng thái"); // NOI18N

        txtNgayLapHD.setEditable(false);
        txtNgayLapHD.setEnabled(false);

        txtSoLuongHD.setName("Số lượng"); // NOI18N

        txtthanhtien.setEditable(false);
        txtthanhtien.setName("Thành tiền"); // NOI18N
        txtthanhtien.setOpaque(false);

        txtmanv_HD.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        txtmanv_HD.setEnabled(false);
        txtmanv_HD.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtmanv_HDActionPerformed(evt);
            }
        });

        jLabel9.setText("Mã Hóa Đơn :");

        jLabel25.setText("Mã Sản Phẩm :");

        jLabel11.setText("Mã Khách Hàng :");

        jLabel13.setText("Trạng Thái :");

        jLabel10.setText("Ngày Lập Hóa Đơn :");

        jLabel26.setText("Số Lượng :");

        jLabel12.setText("Giá :");

        jLabel24.setText("Mã Nhân Viên : ");

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 88, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel13)
                    .addComponent(jLabel11)
                    .addComponent(jLabel25))
                .addGap(18, 18, 18)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txttrangthai)
                    .addComponent(cboMaSP, javax.swing.GroupLayout.Alignment.TRAILING, 0, 320, Short.MAX_VALUE)
                    .addComponent(cboMaKH, javax.swing.GroupLayout.Alignment.TRAILING, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(txtmahd, javax.swing.GroupLayout.Alignment.TRAILING))
                .addGap(54, 54, 54)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel24)
                            .addComponent(jLabel26)
                            .addComponent(jLabel12))
                        .addGap(64, 64, 64)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtthanhtien, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(txtSoLuongHD)
                            .addComponent(txtmanv_HD)))
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addComponent(jLabel10)
                        .addGap(42, 42, 42)
                        .addComponent(txtNgayLapHD)))
                .addContainerGap())
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap(32, Short.MAX_VALUE)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtmahd, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel9)
                    .addComponent(jLabel10)
                    .addComponent(txtNgayLapHD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel25)
                    .addComponent(cboMaSP, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel26)
                    .addComponent(txtSoLuongHD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(31, 31, 31)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel11)
                    .addComponent(cboMaKH, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel12)
                    .addComponent(txtthanhtien, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(30, 30, 30)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel13)
                    .addComponent(txttrangthai, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel24)
                    .addComponent(txtmanv_HD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(34, 34, 34))
        );

        jPanel7.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)), "Chức Năng", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 13))); // NOI18N

        btnthemHD.setBackground(new java.awt.Color(255, 255, 255));
        btnthemHD.setForeground(new java.awt.Color(51, 255, 51));
        btnthemHD.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Add.png"))); // NOI18N
        btnthemHD.setText("Thêm");
        btnthemHD.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnthemHDActionPerformed(evt);
            }
        });

        btnxoahd.setBackground(new java.awt.Color(255, 255, 255));
        btnxoahd.setForeground(new java.awt.Color(255, 102, 102));
        btnxoahd.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Delete.png"))); // NOI18N
        btnxoahd.setText("Xóa");
        btnxoahd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnxoahdActionPerformed(evt);
            }
        });

        btnsuahd.setBackground(new java.awt.Color(255, 255, 255));
        btnsuahd.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Update.png"))); // NOI18N
        btnsuahd.setText("Sửa");
        btnsuahd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnsuahdActionPerformed(evt);
            }
        });

        btnMoiHD.setBackground(new java.awt.Color(255, 255, 255));
        btnMoiHD.setForeground(new java.awt.Color(51, 51, 255));
        btnMoiHD.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/New.png"))); // NOI18N
        btnMoiHD.setText("Mới");
        btnMoiHD.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnMoiHDActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnthemHD)
                    .addComponent(btnsuahd))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 145, Short.MAX_VALUE)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnMoiHD, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(btnxoahd, javax.swing.GroupLayout.Alignment.TRAILING))
                .addContainerGap())
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnthemHD)
                    .addComponent(btnxoahd))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnsuahd)
                    .addComponent(btnMoiHD))
                .addContainerGap())
        );

        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)), "Phím Tắt", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 13))); // NOI18N

        btndauhd.setBackground(new java.awt.Color(255, 255, 255));
        btndauhd.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/First.png"))); // NOI18N
        btndauhd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btndauhdActionPerformed(evt);
            }
        });

        btncuoihd.setBackground(new java.awt.Color(255, 255, 255));
        btncuoihd.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Last.png"))); // NOI18N
        btncuoihd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btncuoihdActionPerformed(evt);
            }
        });

        btnluihd.setBackground(new java.awt.Color(255, 255, 255));
        btnluihd.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Previous.png"))); // NOI18N
        btnluihd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnluihdActionPerformed(evt);
            }
        });

        btntoihd.setBackground(new java.awt.Color(255, 255, 255));
        btntoihd.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Next.png"))); // NOI18N
        btntoihd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btntoihdActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(btndauhd)
                .addGap(31, 31, 31)
                .addComponent(btnluihd)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 37, Short.MAX_VALUE)
                .addComponent(btntoihd)
                .addGap(18, 18, 18)
                .addComponent(btncuoihd)
                .addContainerGap())
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addGap(53, 53, 53)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(btntoihd)
                    .addComponent(btnluihd)
                    .addComponent(btncuoihd)
                    .addComponent(btndauhd))
                .addContainerGap(54, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout CapNhapHDLayout = new javax.swing.GroupLayout(CapNhapHD);
        CapNhapHD.setLayout(CapNhapHDLayout);
        CapNhapHDLayout.setHorizontalGroup(
            CapNhapHDLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(CapNhapHDLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(CapNhapHDLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(CapNhapHDLayout.createSequentialGroup()
                        .addComponent(jPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 261, Short.MAX_VALUE)
                        .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        CapNhapHDLayout.setVerticalGroup(
            CapNhapHDLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(CapNhapHDLayout.createSequentialGroup()
                .addGap(26, 26, 26)
                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(63, 63, 63)
                .addGroup(CapNhapHDLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(34, 34, 34))
        );

        TabHoaDon.addTab("Quản lý", CapNhapHD);

        tblHd.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null}
            },
            new String [] {
                "Mã HD", "Mã SP", "Số Lượng", "Ngày Lập Hóa Đơn", "Mã KH", "Giá", "Mã NV", "Thành Tiền"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, true
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblHd.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblHdMouseClicked(evt);
            }
        });
        jScrollPane3.setViewportView(tblHd);

        jLabel8.setText("Tìm Kiếm ");

        txtTimKiemHD.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtTimKiemHDKeyReleased(evt);
            }
        });

        btnXuatHD.setBackground(new java.awt.Color(255, 255, 255));
        btnXuatHD.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Aprint.png"))); // NOI18N
        btnXuatHD.setText("Xuất File Excel");
        btnXuatHD.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXuatHDActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout DanhSachHDLayout = new javax.swing.GroupLayout(DanhSachHD);
        DanhSachHD.setLayout(DanhSachHDLayout);
        DanhSachHDLayout.setHorizontalGroup(
            DanhSachHDLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DanhSachHDLayout.createSequentialGroup()
                .addGap(21, 21, 21)
                .addGroup(DanhSachHDLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 963, Short.MAX_VALUE)
                    .addGroup(DanhSachHDLayout.createSequentialGroup()
                        .addComponent(jLabel8)
                        .addGap(18, 18, 18)
                        .addComponent(txtTimKiemHD)
                        .addGap(18, 18, 18)
                        .addComponent(btnXuatHD)))
                .addContainerGap())
        );
        DanhSachHDLayout.setVerticalGroup(
            DanhSachHDLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DanhSachHDLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(DanhSachHDLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel8)
                    .addComponent(txtTimKiemHD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnXuatHD))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 410, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(70, Short.MAX_VALUE))
        );

        TabHoaDon.addTab("Danh sách", DanhSachHD);

        TabsQuanLiCuaHang.addTab("HÓA ĐƠN            ", new javax.swing.ImageIcon(getClass().getResource("/Icon/hoadon.png")), TabHoaDon); // NOI18N

        jPanel9.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)), "Cập Nhật", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 13))); // NOI18N

        jLabel19.setText("Mã khách hàng :");

        txtMaKH.setName("Mã khách hàng"); // NOI18N
        txtMaKH.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtMaKHActionPerformed(evt);
            }
        });

        jLabel20.setText("Tên khách hàng :");

        txtTenKH.setName("Tên khách hàng"); // NOI18N

        jLabel21.setText("Số điện thoại :");

        txtSdt_KH.setName("Số điện thoại"); // NOI18N

        jLabel22.setText("Địa chỉ :");

        txtDiachi_KH.setName("Địa chỉ"); // NOI18N

        jLabel23.setText("Email :");

        txtEmail_KH.setName("Email"); // NOI18N

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel9Layout.createSequentialGroup()
                        .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel19)
                            .addComponent(jLabel20)
                            .addComponent(jLabel21))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(txtSdt_KH, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 518, Short.MAX_VALUE)
                            .addComponent(txtMaKH, javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtTenKH, javax.swing.GroupLayout.Alignment.LEADING))
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(jPanel9Layout.createSequentialGroup()
                        .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel22)
                            .addComponent(jLabel23))
                        .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel9Layout.createSequentialGroup()
                                .addGap(83, 83, 83)
                                .addComponent(txtEmail_KH, javax.swing.GroupLayout.PREFERRED_SIZE, 526, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel9Layout.createSequentialGroup()
                                .addGap(91, 91, 91)
                                .addComponent(txtDiachi_KH, javax.swing.GroupLayout.PREFERRED_SIZE, 518, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGap(46, 46, 46))))
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel19)
                    .addComponent(txtMaKH, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 66, Short.MAX_VALUE)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel20)
                    .addComponent(txtTenKH, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(66, 66, 66)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel21)
                    .addComponent(txtSdt_KH, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(68, 68, 68)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel22)
                    .addComponent(txtDiachi_KH, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(66, 66, 66)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel23)
                    .addComponent(txtEmail_KH, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(40, 40, 40))
        );

        jPanel10.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)), "Chức Năng", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 13))); // NOI18N

        btnThemKH.setBackground(new java.awt.Color(255, 255, 255));
        btnThemKH.setForeground(new java.awt.Color(0, 0, 204));
        btnThemKH.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Add.png"))); // NOI18N
        btnThemKH.setText("Thêm");
        btnThemKH.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThemKHActionPerformed(evt);
            }
        });

        btnXoaKH.setBackground(new java.awt.Color(255, 255, 255));
        btnXoaKH.setForeground(new java.awt.Color(255, 51, 51));
        btnXoaKH.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Delete.png"))); // NOI18N
        btnXoaKH.setText("Xoá");
        btnXoaKH.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXoaKHActionPerformed(evt);
            }
        });

        btnSuaKH.setBackground(new java.awt.Color(255, 255, 255));
        btnSuaKH.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Update.png"))); // NOI18N
        btnSuaKH.setText("Sửa");
        btnSuaKH.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSuaKHActionPerformed(evt);
            }
        });

        btnMoiKH.setBackground(new java.awt.Color(255, 255, 255));
        btnMoiKH.setForeground(new java.awt.Color(0, 153, 153));
        btnMoiKH.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/New.png"))); // NOI18N
        btnMoiKH.setText("Mới");
        btnMoiKH.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnMoiKHActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(btnThemKH)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 21, Short.MAX_VALUE)
                        .addComponent(btnXoaKH, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(btnSuaKH, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(btnMoiKH, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnThemKH)
                    .addComponent(btnXoaKH))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 59, Short.MAX_VALUE)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnSuaKH)
                    .addComponent(btnMoiKH))
                .addContainerGap())
        );

        jPanel11.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)), "Phím Tắt", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 13))); // NOI18N

        btnLast.setBackground(new java.awt.Color(255, 255, 255));
        btnLast.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Last.png"))); // NOI18N
        btnLast.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLastActionPerformed(evt);
            }
        });

        btnPrev.setBackground(new java.awt.Color(255, 255, 255));
        btnPrev.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Previous.png"))); // NOI18N
        btnPrev.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnPrevActionPerformed(evt);
            }
        });

        btnFirst.setBackground(new java.awt.Color(255, 255, 255));
        btnFirst.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/First.png"))); // NOI18N
        btnFirst.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnFirstActionPerformed(evt);
            }
        });

        btnNext.setBackground(new java.awt.Color(255, 255, 255));
        btnNext.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Next.png"))); // NOI18N
        btnNext.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNextActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel11Layout.createSequentialGroup()
                        .addComponent(btnFirst)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(btnLast))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel11Layout.createSequentialGroup()
                        .addComponent(btnPrev)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(btnNext)))
                .addContainerGap())
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel11Layout.createSequentialGroup()
                .addGap(30, 30, 30)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnLast)
                    .addComponent(btnFirst))
                .addGap(49, 49, 49)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(btnNext)
                    .addComponent(btnPrev))
                .addContainerGap(34, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout CapNhapKHLayout = new javax.swing.GroupLayout(CapNhapKH);
        CapNhapKH.setLayout(CapNhapKHLayout);
        CapNhapKHLayout.setHorizontalGroup(
            CapNhapKHLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(CapNhapKHLayout.createSequentialGroup()
                .addGap(18, 18, 18)
                .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, 710, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(CapNhapKHLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel11, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel10, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(15, Short.MAX_VALUE))
        );
        CapNhapKHLayout.setVerticalGroup(
            CapNhapKHLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(CapNhapKHLayout.createSequentialGroup()
                .addGap(30, 30, 30)
                .addGroup(CapNhapKHLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(CapNhapKHLayout.createSequentialGroup()
                        .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(62, Short.MAX_VALUE))
        );

        TabKhachHang.addTab("Quản lý", CapNhapKH);

        jLabel14.setText("Tìm kiếm :");

        txtTimkiemKH.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtTimkiemKHKeyReleased(evt);
            }
        });

        tblKh.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "Mã khách hàng", "Tên khách hàng", "Số điện thoại", "Địa chỉ", "Email"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblKh.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblKhMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(tblKh);

        btnXuatKH.setBackground(new java.awt.Color(255, 255, 255));
        btnXuatKH.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Aprint.png"))); // NOI18N
        btnXuatKH.setText("Xuất File Excel");
        btnXuatKH.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXuatKHActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout DanhSachKHLayout = new javax.swing.GroupLayout(DanhSachKH);
        DanhSachKH.setLayout(DanhSachKHLayout);
        DanhSachKHLayout.setHorizontalGroup(
            DanhSachKHLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DanhSachKHLayout.createSequentialGroup()
                .addGap(30, 30, 30)
                .addGroup(DanhSachKHLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 941, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(DanhSachKHLayout.createSequentialGroup()
                        .addComponent(jLabel14)
                        .addGap(32, 32, 32)
                        .addComponent(txtTimkiemKH)
                        .addGap(18, 18, 18)
                        .addComponent(btnXuatKH)))
                .addContainerGap(25, Short.MAX_VALUE))
        );
        DanhSachKHLayout.setVerticalGroup(
            DanhSachKHLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DanhSachKHLayout.createSequentialGroup()
                .addGap(28, 28, 28)
                .addGroup(DanhSachKHLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel14)
                    .addComponent(txtTimkiemKH, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnXuatKH))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(39, Short.MAX_VALUE))
        );

        TabKhachHang.addTab("Danh sách", DanhSachKH);

        TabsQuanLiCuaHang.addTab("   KHÁCH HÀNG         ", new javax.swing.ImageIcon(getClass().getResource("/Icon/khachhang.png")), TabKhachHang); // NOI18N

        jPanel12.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)), "Đổi Mật Khẩu", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 13))); // NOI18N

        jLabel3.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel3.setText("Tên Đăng Nhập :");

        txttennv.setName("Tên đăng nhập"); // NOI18N
        txttennv.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txttennvActionPerformed(evt);
            }
        });

        jLabel4.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel4.setText("Mật Khẩu Hiện Tại :");

        txtmatkhau.setName("Mật khẩu cũ"); // NOI18N

        jLabel5.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel5.setText("Mật Khẩu Mới :");

        txtmatkhaumoi.setName("Mật khẩu mới"); // NOI18N
        txtmatkhaumoi.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtmatkhaumoiActionPerformed(evt);
            }
        });

        jLabel6.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel6.setText("Nhập Lại Mật Khẩu Mới :");

        txtnhaplaimatkhau.setName("Mật khẩu mới"); // NOI18N
        txtnhaplaimatkhau.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtnhaplaimatkhauActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addGap(25, 25, 25)
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel3)
                    .addComponent(jLabel6)
                    .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addComponent(jLabel5)
                        .addComponent(jLabel4)
                        .addComponent(txtmatkhau, javax.swing.GroupLayout.DEFAULT_SIZE, 598, Short.MAX_VALUE)
                        .addComponent(txtnhaplaimatkhau)
                        .addComponent(txtmatkhaumoi)
                        .addComponent(txttennv)))
                .addContainerGap(20, Short.MAX_VALUE))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel3)
                .addGap(35, 35, 35)
                .addComponent(txttennv, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(33, 33, 33)
                .addComponent(jLabel4)
                .addGap(23, 23, 23)
                .addComponent(txtmatkhau, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(37, 37, 37)
                .addComponent(jLabel5)
                .addGap(29, 29, 29)
                .addComponent(txtmatkhaumoi, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(35, 35, 35)
                .addComponent(jLabel6)
                .addGap(26, 26, 26)
                .addComponent(txtnhaplaimatkhau, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(29, Short.MAX_VALUE))
        );

        jPanel13.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)), "Chức Năng", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 13))); // NOI18N

        btndongy.setBackground(new java.awt.Color(255, 255, 255));
        btndongy.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btndongy.setText("Đồng Ý");
        btndongy.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(255, 102, 51)));
        btndongy.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btndongyActionPerformed(evt);
            }
        });

        btnMoi.setBackground(new java.awt.Color(255, 255, 255));
        btnMoi.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btnMoi.setText("Làm Mới");
        btnMoi.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 204, 255)));
        btnMoi.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnMoiActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel13Layout.createSequentialGroup()
                .addContainerGap(50, Short.MAX_VALUE)
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btndongy, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnMoi, javax.swing.GroupLayout.DEFAULT_SIZE, 96, Short.MAX_VALUE))
                .addGap(47, 47, 47))
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addGap(48, 48, 48)
                .addComponent(btndongy, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 132, Short.MAX_VALUE)
                .addComponent(btnMoi, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(72, 72, 72))
        );

        javax.swing.GroupLayout TabDoiMatKhauLayout = new javax.swing.GroupLayout(TabDoiMatKhau);
        TabDoiMatKhau.setLayout(TabDoiMatKhauLayout);
        TabDoiMatKhauLayout.setHorizontalGroup(
            TabDoiMatKhauLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(TabDoiMatKhauLayout.createSequentialGroup()
                .addGap(31, 31, 31)
                .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(42, 42, 42)
                .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(72, Short.MAX_VALUE))
        );
        TabDoiMatKhauLayout.setVerticalGroup(
            TabDoiMatKhauLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, TabDoiMatKhauLayout.createSequentialGroup()
                .addContainerGap(42, Short.MAX_VALUE)
                .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(81, 81, 81))
            .addGroup(TabDoiMatKhauLayout.createSequentialGroup()
                .addGap(83, 83, 83)
                .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        TabsQuanLiCuaHang.addTab("ĐỔI MẬT KHẨU    ", new javax.swing.ImageIcon(getClass().getResource("/Icon/doimk.png")), TabDoiMatKhau); // NOI18N

        jPanel14.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)), "Quản Lý", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 13))); // NOI18N

        jButton1.setBackground(new java.awt.Color(255, 255, 255));
        jButton1.setFont(new java.awt.Font("Tahoma", 1, 36)); // NOI18N
        jButton1.setText("Nhân Viên");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jButton2.setBackground(new java.awt.Color(255, 255, 255));
        jButton2.setFont(new java.awt.Font("Tahoma", 1, 36)); // NOI18N
        jButton2.setText("Doanh Thu");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel14Layout = new javax.swing.GroupLayout(jPanel14);
        jPanel14.setLayout(jPanel14Layout);
        jPanel14Layout.setHorizontalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel14Layout.createSequentialGroup()
                .addGap(42, 42, 42)
                .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 440, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 36, Short.MAX_VALUE)
                .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 400, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(43, 43, 43))
        );
        jPanel14Layout.setVerticalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel14Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 400, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 400, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(41, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addGap(25, 25, 25)
                .addComponent(jPanel14, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel14, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        TabQuanLy.addTab("Chức năng", jPanel4);

        TabsQuanLiCuaHang.addTab("   QUẢN LÝ           ", new javax.swing.ImageIcon(getClass().getResource("/Icon/CIO.png")), TabQuanLy); // NOI18N

        btnDangXuat.setBackground(new java.awt.Color(255, 255, 255));
        btnDangXuat.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        btnDangXuat.setForeground(new java.awt.Color(255, 51, 0));
        btnDangXuat.setText("Đăng Xuất");
        btnDangXuat.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDangXuatActionPerformed(evt);
            }
        });
        TabsQuanLiCuaHang.addTab("ĐĂNG XUẤT        ", new javax.swing.ImageIcon(getClass().getResource("/Icon/dangxuat.png")), btnDangXuat); // NOI18N

        TabsALL.addTab("QUẢN LÝ CỬA HÀNG   ", new javax.swing.ImageIcon(getClass().getResource("/Icon/quan-ly-ban-hang.png")), TabsQuanLiCuaHang, ""); // NOI18N

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(6, 6, 6)
                .addComponent(TabsALL, javax.swing.GroupLayout.PREFERRED_SIZE, 1218, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(TabsALL, javax.swing.GroupLayout.PREFERRED_SIZE, 628, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        openDoanhThu();
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton2ActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        openNhanVien();
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton1ActionPerformed

    private void btnMoiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnMoiActionPerformed
        txttennv.setText("");
        txtmatkhau.setText("");
        txtmatkhaumoi.setText("");
        txtnhaplaimatkhau.setText("");
        // TODO add your handling code here:

    }//GEN-LAST:event_btnMoiActionPerformed

    private void btndongyActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btndongyActionPerformed
        if (utilityHelper.checkNullText(txttennv)
                && utilityHelper.checkNullPass(txtmatkhau)
                && utilityHelper.checkNullPass(txtmatkhaumoi)
                && utilityHelper.checkNullPass(txtnhaplaimatkhau)) {
            doiMatKhau();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btndongyActionPerformed

    private void txttennvActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txttennvActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txttennvActionPerformed

    private void txtnhaplaimatkhauActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtnhaplaimatkhauActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtnhaplaimatkhauActionPerformed

    private void txtmatkhaumoiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtmatkhaumoiActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtmatkhaumoiActionPerformed

    private void tblKhMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblKhMouseClicked
        // TODO add your handling code here:
        if (evt.getClickCount() == 2) {
            this.row = tblKh.rowAtPoint(evt.getPoint());
            if (this.row >= 0) {
                this.edit();
                TabKhachHang.setSelectedIndex(0);
            }
        }
    }//GEN-LAST:event_tblKhMouseClicked

    private void btnLastActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLastActionPerformed
        Last();        // TODO add your handling code here:
    }//GEN-LAST:event_btnLastActionPerformed

    private void btnFirstActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnFirstActionPerformed
        first();        // TODO add your handling code here:
    }//GEN-LAST:event_btnFirstActionPerformed

    private void btnNextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNextActionPerformed
        next();        // TODO add your handling code here:
    }//GEN-LAST:event_btnNextActionPerformed

    private void btnPrevActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnPrevActionPerformed
        // TODO add your handling code here:
        Prev();
    }//GEN-LAST:event_btnPrevActionPerformed

    private void btnMoiKHActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnMoiKHActionPerformed
        clearFormKH();        // TODO add your handling code here:
    }//GEN-LAST:event_btnMoiKHActionPerformed

    private void btnSuaKHActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSuaKHActionPerformed
        if (utilityHelper.checkNullText(txtMaKH)
                && utilityHelper.checkNullText(txtTenKH)
                && utilityHelper.checkNullText(txtSdt_KH)
                && utilityHelper.checkNullText(txtDiachi_KH)
                && utilityHelper.checkNullText(txtEmail_KH)) {
            if (utilityHelper.checkMa(txtMaKH)
                    && utilityHelper.checkName(txtTenKH)
                    && utilityHelper.checkSDT(txtSdt_KH)
                    && utilityHelper.checkEmail(txtEmail_KH)) {
                updateKH();
            }
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnSuaKHActionPerformed

    private void btnXoaKHActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXoaKHActionPerformed
        // TODO add your handling code here
        deleteKhachHang();
    }//GEN-LAST:event_btnXoaKHActionPerformed

    private void btnThemKHActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThemKHActionPerformed
        // TODO add your handling code here:
        if (utilityHelper.checkNullText(txtMaKH)
                && utilityHelper.checkNullText(txtTenKH)
                && utilityHelper.checkNullText(txtSdt_KH)
                && utilityHelper.checkNullText(txtDiachi_KH)
                && utilityHelper.checkNullText(txtEmail_KH)) {
            if (utilityHelper.checkMa(txtMaKH)
                    && utilityHelper.checkName(txtTenKH)
                    && utilityHelper.checkSDT(txtSdt_KH)
                    && utilityHelper.checkEmail(txtEmail_KH)) {
                if (checkTrungMaKH(txtMaKH)) {
                    insertKH();
                }
            }
        }
    }//GEN-LAST:event_btnThemKHActionPerformed

    private void txtMaKHActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtMaKHActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtMaKHActionPerformed

    private void btnSuaSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSuaSPActionPerformed
        // TODO add your handling code here:
        if (utilityHelper.checkNullText(txtMaSP1)
                && utilityHelper.checkNullText(txtNhanHieuSP)
                && utilityHelper.checkNullText(txtTenSP)
                && utilityHelper.checkNullText(txtMauSP)
                && utilityHelper.checkNullText(txtSoLuongSP)
                && utilityHelper.checkNullText(txtGiaSP)
                && checkNullHinh()) {
            if (utilityHelper.checkMa(txtMaSP1)
                    && utilityHelper.checkSoLuong(txtSoLuongSP)
                    && utilityHelper.checkGiaTien(txtGiaSP)) {
                updateSP();

            }
        }
    }//GEN-LAST:event_btnSuaSPActionPerformed

    private void btnMoiSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnMoiSPActionPerformed
        // TODO add your handling code here:
        clearFormSP();
    }//GEN-LAST:event_btnMoiSPActionPerformed

    private void btnXoaSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXoaSPActionPerformed
        // TODO add your handling code here:
        deleteSP();
    }//GEN-LAST:event_btnXoaSPActionPerformed

    private void btnThemSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThemSPActionPerformed
        // TODO add your handling code here:
        if (utilityHelper.checkNullText(txtMaSP1)
                && utilityHelper.checkNullText(txtNhanHieuSP)
                && utilityHelper.checkNullText(txtTenSP)
                && utilityHelper.checkNullText(txtMauSP)
                && utilityHelper.checkNullText(txtSoLuongSP)
                && utilityHelper.checkNullText(txtGiaSP)
                && checkNullHinh()) {
            if (utilityHelper.checkMa(txtMaSP1)
                    && utilityHelper.checkSoLuong(txtSoLuongSP)
                    && utilityHelper.checkGiaTien(txtGiaSP)) {
                if (checkTrungMaSP(txtMaSP1)) {
                    insertSP();
                }
            }
        }
    }//GEN-LAST:event_btnThemSPActionPerformed

    private void txtGiaSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtGiaSPActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtGiaSPActionPerformed

    private void btnDangXuatActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDangXuatActionPerformed
        this.dangXuat();
        // TODO add your handling code here:
    }//GEN-LAST:event_btnDangXuatActionPerformed

    private void btnXuatSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXuatSPActionPerformed

        // TODO add your handling code here:
        printSP();
    }//GEN-LAST:event_btnXuatSPActionPerformed

    private void btnFirtSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnFirtSPActionPerformed
        // TODO add your handling code here:
        FirtSP();
    }//GEN-LAST:event_btnFirtSPActionPerformed

    private void tblSPMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblSPMouseClicked
        // TODO add your handling code here:
        if (evt.getClickCount() == 2) {
            this.row = tblSP.rowAtPoint(evt.getPoint());
            if (this.row >= 0) {
                this.editSP();
                TabSanPham.setSelectedIndex(0);
            }
        }
    }//GEN-LAST:event_tblSPMouseClicked

    private void TabsQuanLiCuaHangAncestorAdded(javax.swing.event.AncestorEvent evt) {//GEN-FIRST:event_TabsQuanLiCuaHangAncestorAdded
        // TODO add your handling code here:
    }//GEN-LAST:event_TabsQuanLiCuaHangAncestorAdded

    private void btnPreSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnPreSPActionPerformed
        // TODO add your handling code here:
        PrevSP();
    }//GEN-LAST:event_btnPreSPActionPerformed

    private void btnNexSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNexSPActionPerformed
        // TODO add your handling code here:
        NextSP();
    }//GEN-LAST:event_btnNexSPActionPerformed

    private void btnLasSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLasSPActionPerformed
        // TODO add your handling code here:
        LastSP();
    }//GEN-LAST:event_btnLasSPActionPerformed

    private void btnthemHDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnthemHDActionPerformed
        if (utilityHelper.checkNullText(txtmahd)
                && utilityHelper.checkNullText(txtSoLuongHD)
                && utilityHelper.checkNullText(txtthanhtien)
                && utilityHelper.checkNullText(txttrangthai)) {
            if (utilityHelper.checkMa(txtmahd)
                    && utilityHelper.checkSoLuong(txtSoLuongHD)
                    && utilityHelper.checkGiaTien(txtthanhtien)
                    && utilityHelper.checkTrangThaiHD(txttrangthai)) {
                if (checkTrungMaHD(txtmahd)) {
                    inserthd();
                }
            }
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnthemHDActionPerformed

    private void tblHdMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblHdMouseClicked
        // TODO add your handling code here:
        if (evt.getClickCount() == 2) {
            this.row = tblHd.rowAtPoint(evt.getPoint());
            if (this.row >= 0) {
                this.editHD();
                TabHoaDon.setSelectedIndex(0);
            }
        }
    }//GEN-LAST:event_tblHdMouseClicked

    private void btnMoiHDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnMoiHDActionPerformed
        // TODO add your handling code here:
        clearformhd();
    }//GEN-LAST:event_btnMoiHDActionPerformed

    private void btnxoahdActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnxoahdActionPerformed
        this.deletehd();
        // TODO add your handling code here:
    }//GEN-LAST:event_btnxoahdActionPerformed

    private void btnsuahdActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnsuahdActionPerformed
        if (utilityHelper.checkNullText(txtmahd)
                && utilityHelper.checkNullText(txtSoLuongHD)
                && utilityHelper.checkNullText(txtthanhtien)
                && utilityHelper.checkNullText(txttrangthai)) {
            if (utilityHelper.checkMa(txtmahd)
                    && utilityHelper.checkSoLuong(txtSoLuongHD)
                    && utilityHelper.checkGiaTien(txtthanhtien)
                    && utilityHelper.checkTrangThaiHD(txttrangthai)) {
                updatehd();
            }
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnsuahdActionPerformed

    private void btndauhdActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btndauhdActionPerformed
        this.dauhd();
        // TODO add your handling code here:
    }//GEN-LAST:event_btndauhdActionPerformed

    private void btnluihdActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnluihdActionPerformed
        this.luihd();
        // TODO add your handling code here:
    }//GEN-LAST:event_btnluihdActionPerformed

    private void btntoihdActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btntoihdActionPerformed
        this.toihd();
        // TODO add your handling code here:
    }//GEN-LAST:event_btntoihdActionPerformed

    private void btncuoihdActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btncuoihdActionPerformed
        this.cuoihd();
        // TODO add your handling code here:
    }//GEN-LAST:event_btncuoihdActionPerformed

    private void txtTimkiemKHKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtTimkiemKHKeyReleased
        // TODO add your handling code here:
        fillTableTimKiemKH();
    }//GEN-LAST:event_txtTimkiemKHKeyReleased

    private void txtTimkiemSPKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtTimkiemSPKeyReleased
        // TODO add your handling code here:
        fillTableTimKiemSP();
    }//GEN-LAST:event_txtTimkiemSPKeyReleased

    private void txtTimKiemHDKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtTimKiemHDKeyReleased
        // TODO add your handling code here:
        fillTableTimKiemHD();
    }//GEN-LAST:event_txtTimKiemHDKeyReleased

    private void txtTimkiemSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtTimkiemSPActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtTimkiemSPActionPerformed

    private void btnXuatHDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXuatHDActionPerformed
        // TODO add your handling code here:
        printHD();
    }//GEN-LAST:event_btnXuatHDActionPerformed

    private void lblHinhMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_lblHinhMouseClicked
        // TODO add your handling code here:
        this.selectImage();
    }//GEN-LAST:event_lblHinhMouseClicked

    private void btnXuatKHActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXuatKHActionPerformed
        // TODO add your handling code here:
        printKH();
    }//GEN-LAST:event_btnXuatKHActionPerformed

    private void txtmanv_HDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtmanv_HDActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtmanv_HDActionPerformed

    private void cboMaSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cboMaSPActionPerformed
        // TODO add your handling code here:
        selectComboBoxSP();
    }//GEN-LAST:event_cboMaSPActionPerformed

    private void cboMaKHActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cboMaKHActionPerformed
        // TODO add your handling code here:
        selectComboBoxKH();
    }//GEN-LAST:event_cboMaKHActionPerformed

    private void txtMauSPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtMauSPActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtMauSPActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(FormChinh.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(FormChinh.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(FormChinh.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(FormChinh.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new FormChinh().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel CapNhapHD;
    private javax.swing.JPanel CapNhapKH;
    private javax.swing.JPanel CapNhapSP;
    private javax.swing.JPanel DanhSachHD;
    private javax.swing.JPanel DanhSachKH;
    private javax.swing.JPanel DanhSachSP;
    private javax.swing.JPanel TabDoiMatKhau;
    private javax.swing.JTabbedPane TabHoaDon;
    private javax.swing.JTabbedPane TabKhachHang;
    private javax.swing.JTabbedPane TabQuanLy;
    private javax.swing.JTabbedPane TabSanPham;
    private javax.swing.JPanel TabTrangChu;
    private javax.swing.JTabbedPane TabsALL;
    private javax.swing.JTabbedPane TabsQuanLiCuaHang;
    private javax.swing.JButton btnDangXuat;
    private javax.swing.JButton btnFirst;
    private javax.swing.JButton btnFirtSP;
    private javax.swing.JButton btnLasSP;
    private javax.swing.JButton btnLast;
    private javax.swing.JButton btnMoi;
    private javax.swing.JButton btnMoiHD;
    private javax.swing.JButton btnMoiKH;
    private javax.swing.JButton btnMoiSP;
    private javax.swing.JButton btnNexSP;
    private javax.swing.JButton btnNext;
    private javax.swing.JButton btnPreSP;
    private javax.swing.JButton btnPrev;
    private javax.swing.JButton btnSuaKH;
    private javax.swing.JButton btnSuaSP;
    private javax.swing.JButton btnThemKH;
    private javax.swing.JButton btnThemSP;
    private javax.swing.JButton btnXoaKH;
    private javax.swing.JButton btnXoaSP;
    private javax.swing.JButton btnXuatHD;
    private javax.swing.JButton btnXuatKH;
    private javax.swing.JButton btnXuatSP;
    private javax.swing.JButton btncuoihd;
    private javax.swing.JButton btndauhd;
    private javax.swing.JButton btndongy;
    private javax.swing.JButton btnluihd;
    private javax.swing.JButton btnsuahd;
    private javax.swing.JButton btnthemHD;
    private javax.swing.JButton btntoihd;
    private javax.swing.JButton btnxoahd;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.ButtonGroup buttonGroup2;
    private javax.swing.JComboBox cbbSize;
    private javax.swing.JComboBox cboMaKH;
    private javax.swing.JComboBox cboMaSP;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel28;
    private javax.swing.JLabel jLabel29;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel14;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JLabel lblDongHo;
    private javax.swing.JLabel lblHinh;
    private javax.swing.JLabel lblday;
    private javax.swing.JTable tblHd;
    private javax.swing.JTable tblKh;
    private javax.swing.JTable tblSP;
    private javax.swing.JTextField txtDiachi_KH;
    private javax.swing.JTextField txtEmail_KH;
    private javax.swing.JTextField txtGiaSP;
    private javax.swing.JTextField txtMaKH;
    private javax.swing.JTextField txtMaSP1;
    private javax.swing.JTextField txtMauSP;
    private javax.swing.JTextField txtNgayLapHD;
    private javax.swing.JTextField txtNhanHieuSP;
    private javax.swing.JTextField txtSdt_KH;
    private javax.swing.JTextField txtSoLuongHD;
    private javax.swing.JTextField txtSoLuongSP;
    private javax.swing.JTextField txtTenKH;
    private javax.swing.JTextField txtTenSP;
    private javax.swing.JTextField txtTimKiemHD;
    private javax.swing.JTextField txtTimkiemKH;
    private javax.swing.JTextField txtTimkiemSP;
    private javax.swing.JTextField txtmahd;
    private javax.swing.JTextField txtmanv_HD;
    private javax.swing.JPasswordField txtmatkhau;
    private javax.swing.JPasswordField txtmatkhaumoi;
    private javax.swing.JPasswordField txtnhaplaimatkhau;
    private javax.swing.JTextField txttennv;
    private javax.swing.JTextField txtthanhtien;
    private javax.swing.JTextField txttrangthai;
    // End of variables declaration//GEN-END:variables
private void init() {
        setTitle("Quản Lý SHOP");
        setIconImage(XImage.getAppIcon());
        new Timer(1000, new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                java.util.Date now = new java.util.Date();
                SimpleDateFormat formater = new SimpleDateFormat("hh:mm:ss a");
                String text = formater.format(now);
                lblDongHo.setText(text);
            }
        }).start();

        java.util.Date now = new java.util.Date();
        SimpleDateFormat formater = new SimpleDateFormat("dd/MM/yyyy");
        String text = formater.format(now);
        lblday.setText(text);

        this.setLocationRelativeTo(null);
        new ChaoJDialog(this, true).setVisible(true);
        new DangNhapJDialog(this, true).setVisible(true);
    }

    private void loadKhachHang() {
        this.filltable();
        this.updateStatus();
        TabKhachHang.setSelectedIndex(1);

    }

    private void loadSanPham() {
        this.filltableSP();
        this.updateStatusSP();
        TabSanPham.setSelectedIndex(1);

    }

    private void loadhd() {
        this.filltablehd();
        this.fillComboBoxHD();
        this.fillComboBoxKH();
        this.updateStatusHD();
        TabHoaDon.setSelectedIndex(1);
    }
    // -------------------------------------------------------------------------- DOi MAT KHAU
    NhanVienDAO dao = new NhanVienDAO();

    private void doiMatKhau() {
        String manv = txttennv.getText();
        String matKhau = new String(txtmatkhau.getPassword());
        String matKhauMoi = new String(txtmatkhaumoi.getPassword());
        String matKhauMoi2 = new String(txtnhaplaimatkhau.getPassword());

        if (!manv.equalsIgnoreCase(Auth.user.getMaNV())) {
            MsgBox.alert(this, "Sai tên đăng nhập!");
        } else if (!matKhau.equals(Auth.user.getMatKhau())) {
            MsgBox.alert(this, "Sai mật khẩu!");
        } else if (!matKhauMoi.equals(matKhauMoi2)) {
            MsgBox.alert(this, "Xác nhận mật khẩu không đúng!");
        } else {
            Auth.user.setMatKhau(matKhauMoi);
            dao.update(Auth.user);
            MsgBox.alert(this, "Đổi mật khẩu thành công!");
        }
    }

    void openNhanVien() {
        if (Auth.isLogin()) {
            if (!Auth.isManager()) {
                MsgBox.alert(this, "Bạn không có quyền xem nhân viên");
                return;
            }
            NhanvienJDialog nv = new NhanvienJDialog(this, true);
            nv.setVisible(true);
        } else {
            MsgBox.alert(this, "Vui lòng đăng nhập!");
        }
    }

    void openDoanhThu() {
        if (Auth.isLogin()) {
            if (!Auth.isManager()) {
                MsgBox.alert(this, "Bạn không có quyền xem doanh thu");
                return;
            }
            DoanhThuJDialog dt = new DoanhThuJDialog(this, true);
            dt.setVisible(true);
        } else {
            MsgBox.alert(this, "Vui lòng đăng nhập!");
        }

    }

    private void huyBo() {
        this.dispose();
    }
//------------------------------------------------------------------------------ KHACH HANG

    KhachHangDAO khDao = new KhachHangDAO();
    int row = -1;

    void fillTableTimKiemKH() {
        DefaultTableModel model = (DefaultTableModel) tblKh.getModel();
        model.setRowCount(1);
        String keyword = txtTimkiemKH.getText();
        List<KhachHang> list = khDao.selectByKeywordKH(keyword);

        for (KhachHang kh : list) {
            model.addRow(new Object[]{
                kh.getMaKH(),
                kh.getTenKH(),
                kh.getsDT(),
                kh.getDiaChi(),
                kh.getEmail()

            });

        }
    }
    DefaultTableModel modelKH;

    void filltable() {
        modelKH = (DefaultTableModel) tblKh.getModel();
        modelKH.setRowCount(0);
        try {
            List<KhachHang> list = khDao.selectAll();
            for (KhachHang kh : list) {
                Object[] row = {
                    kh.getMaKH(),
                    kh.getTenKH(),
                    kh.getsDT(),
                    kh.getDiaChi(),
                    kh.getEmail()
                };
                modelKH.addRow(row);
            }
        } catch (Exception e) {
            MsgBox.alert(this, "Lỗi truy vấn dữ liệu");
        }
    }
    JFileChooser fileChooser = new JFileChooser();

    void selectImage() {
        if (fileChooser.showOpenDialog(this) == JFileChooser.APPROVE_OPTION) { //nếu người dùng đã chọn đc file
            File file = fileChooser.getSelectedFile();    //lấy file người dùng chọn
            if (XImage.saveLogo(file)) {  //sao chép file đã chọn thư mục logos
                // Hiển thị hình lên form
                lblHinh.setIcon(XImage.readLogo(file.getName())); //file.getName(); lấy tên của file
                //ImageIcon readLogo(String tenFile) đọc file trong thư mục logos theo tên file trả về ImageIcon
                //void setIcon(ImageIcon icon) set Icon cho lbl
                lblHinh.setToolTipText(file.getName());
            }
        }
    }

    private void edit() {
        try {
            String maKH = (String) tblKh.getValueAt(this.row, 0);
            KhachHang kh = khDao.selectById(maKH);
            this.setForm(kh);
            TabKhachHang.setSelectedIndex(0);
            this.updateStatus();
        } catch (Exception e) {
            System.out.println("edit:  " + e);
        }
    }

    KhachHang getForm() {
        KhachHang kh = new KhachHang();
        kh.setMaKH(txtMaKH.getText());
        kh.setTenKH(txtTenKH.getText());
        kh.setsDT(txtSdt_KH.getText());
        kh.setDiaChi(txtDiachi_KH.getText());
        kh.setEmail(txtEmail_KH.getText());
        return kh;
    }

    private void setForm(KhachHang kh) {
        txtMaKH.setText(kh.getMaKH());
        txtTenKH.setText(kh.getTenKH());
        txtSdt_KH.setText(kh.getsDT());
        txtDiachi_KH.setText(kh.getDiaChi());
        txtEmail_KH.setText(kh.getEmail());
    }

    private void clearFormKH() {

        filltable();
        txtMaKH.setText("");
        txtTenKH.setText("");
        txtSdt_KH.setText("");
        txtDiachi_KH.setText("");
        txtEmail_KH.setText("");;
        btnThemKH.setEnabled(true);
        btnXoaKH.setEnabled(false);
        btnSuaKH.setEnabled(false);
        txtMaKH.setEditable(true);
    }

    private void updateStatus() {
        boolean edit = (this.row >= 0);
        boolean first = (this.row == 0);
        boolean last = (this.row == tblKh.getRowCount() - 1);

        txtMaKH.setEditable(!edit);
        btnThemKH.setEnabled(!edit);
        btnSuaKH.setEnabled(edit);
        btnXoaKH.setEnabled(edit);

        btnFirst.setEnabled(edit && !first);
        btnPrev.setEnabled(edit && !first);
        btnNext.setEnabled(edit && !last);
        btnLast.setEnabled(edit && !last);
    }

    private void insertKH() {
        if (!Auth.isLogin()) {
            MsgBox.alert(this, "Bạn cần đăng nhập!");
        } else {
        KhachHang kh = getForm();
        try {
            khDao.insert(kh);
            this.filltable();
            this.clearFormKH();
            fillComboBoxKH();
            MsgBox.alert(this, "Thêm mới thành công");
        } catch (Exception e) {
            MsgBox.alert(this, "Thêm mới thất bại !");
        }}
    }

    private void updateKH() {
        if (!Auth.isLogin()) {
            MsgBox.alert(this, "Bạn cần đăng nhập!");
        } else {
        KhachHang kh = getForm();
        try {
            khDao.update(kh);
            this.filltable();
            MsgBox.alert(this, "Update thành công ");
        } catch (Exception e) {
            MsgBox.alert(this, "Update thành công ");
        }}
    }

    private void deleteKhachHang() {
        if (!Auth.isLogin()) {
            MsgBox.alert(this, "Bạn cần đăng nhập!");
        } else {
            String manv = txtMaKH.getText();
            if (MsgBox.confirm(this, "Bạn thực sự muốn xóa khách hàng này ?")) {
                try {
                    khDao.delete(manv);
                    this.filltable();
                    this.clearFormKH();
                    MsgBox.alert(this, "Xóa thành công ");
                } catch (Exception e) {
                    MsgBox.alert(this, "Xóa thất bại !");
                }
            }
        }
//        }
    }

    private void first() {
        this.row = 0;
        this.edit();
    }

    private void Prev() {
        if (this.row > 0) {
            this.row--;
            this.edit();
        }
    }

    private void next() {
        if (this.row < tblKh.getRowCount() - 1) {
            this.row++;
            this.edit();
        }
    }

    private void Last() {
        this.row = tblKh.getRowCount() - 1;
        this.edit();
    }

    void printKH() {
        FileOutputStream excelfou = null;
        BufferedOutputStream excelBOU = null;
        XSSFWorkbook exceljtableExporter = null;
        //chon noi luu file 
        JFileChooser excelfile = new JFileChooser("d:\\prinexcel");
        //Thanh tiu de
        excelfile.setDialogTitle("Save As");
        //cac dang ten duoi mo rong cua excel
        FileNameExtensionFilter fnef = new FileNameExtensionFilter("EXCEL FILES", "xls", "xlxs", "xlsm");
        excelfile.setFileFilter(fnef);
        int excelchoose = excelfile.showSaveDialog(null);

        //kiểm tra xem nút lưu có được nhấp không
        if (excelchoose == JFileChooser.APPROVE_OPTION) {
            try {
                //import thu vien apache poi excel
                exceljtableExporter = new XSSFWorkbook();
                XSSFSheet excelsheet = exceljtableExporter.createSheet("HoaDon");
                // vòng lặp để lấy cột và hàng của bảng
                for (int i = 0; i < modelKH.getRowCount(); i++) {
                    XSSFRow excelrow = excelsheet.createRow(i);
                    for (int j = 0; j < modelKH.getColumnCount(); j++) {
                        XSSFCell excelCell = excelrow.createCell(j);
                        excelCell.setCellValue(tblKh.getValueAt(i, j).toString());
                    }
                }
                //nối phần mở rộng tệp xlsx vào các tệp đã chọn. để tạo tên tệp duy nhất  
                excelfou = new FileOutputStream(excelfile.getSelectedFile() + ".xlsx");
                excelBOU = new BufferedOutputStream(excelfou);
                exceljtableExporter.write(excelBOU);
                JOptionPane.showMessageDialog(this, "Tạo và thêm thành công");
            } catch (FileNotFoundException ex) {
                ex.printStackTrace();
            } catch (IOException ex) {
                Logger.getLogger(FormChinh.class.getName()).log(Level.SEVERE, null, ex);
            } finally {
                try {
                    if (excelBOU != null) {
                        excelBOU.close();
                    }
                    if (excelfou != null) {
                        excelfou.close();
                    }
                    if (exceljtableExporter != null) {
                        exceljtableExporter.close();
                    }
                } catch (IOException ex) {
                    ex.printStackTrace();
                }
            }
        }
    }

    public boolean checkTrungMaKH(JTextField txt) {
        txt.setBackground(white);
        if (khDao.selectById(txt.getText()) == null) {
            return true;
        } else {
            txt.setBackground(pink);
            MsgBox.alert(this, txt.getName() + " đã bị tồn tại.");
            return false;
        }
    }

    //-------------------------------------------------------------------------- SAN PHAM
    SanPhamDAO SpDao = new SanPhamDAO();

    void fillTableTimKiemSP() {
        DefaultTableModel model = (DefaultTableModel) tblSP.getModel();
        model.setRowCount(1);

        String keyword = txtTimkiemSP.getText();
        List<SanPham> list = SpDao.selectByKeywordSP(keyword);
        for (SanPham sp : list) {
            model.addRow(new Object[]{
                sp.getMaSP(),
                sp.getNhanHieu(),
                sp.getTen(),
                sp.getMau(),
                sp.getSize(),
                sp.getSoLuong(),
                sp.getGiaTien(),
                sp.getHinh()
            });

        }
    }
    DefaultTableModel modelSP;

    void filltableSP() {
        modelSP = (DefaultTableModel) tblSP.getModel();
        modelSP.setRowCount(0);
        try {
            List<SanPham> tblSP = SpDao.selectAll();
            for (SanPham sp : tblSP) {
                Object[] row = {
                    sp.getMaSP(),
                    sp.getNhanHieu(),
                    sp.getTen(),
                    sp.getMau(),
                    sp.getSize(),
                    sp.getSoLuong(),
                    sp.getGiaTien(),
                    sp.getHinh()

                };
                modelSP.addRow(row);
            }
        } catch (Exception e) {
            MsgBox.alert(this, "Lỗi truy vấn dữ liệu");
        }
    }

    private void editSP() {
        try {
            String MaSP = (String) tblSP.getValueAt(this.row, 0);
            SanPham sp = SpDao.selectById(MaSP);
            this.setFormSP(sp);
            TabSanPham.setSelectedIndex(0);
            this.updateStatusSP();
        } catch (Exception e) {
            System.out.println("edit:  " + e);
        }
    }

    SanPham getFormSP() {

        SanPham sp = new SanPham();
        sp.setMaSP(txtMaSP1.getText());
        sp.setNhanHieu(txtNhanHieuSP.getText());
        sp.setTen(txtTenSP.getText());
        sp.setMau(txtMauSP.getText());
        sp.setSize((String) cbbSize.getSelectedItem());
        sp.setSoLuong(new Integer(txtSoLuongSP.getText()));
        sp.setGiaTien(new Double(txtGiaSP.getText()));
        sp.setHinh(lblHinh.getToolTipText());
        return sp;
    }

    private void setFormSP(SanPham sp) {
        txtMaSP1.setText(sp.getMaSP());
        txtNhanHieuSP.setText(sp.getNhanHieu());
        txtTenSP.setText(sp.getTen());
        txtMauSP.setText(sp.getMau());
        cbbSize.setSelectedItem(sp.getSize());
        txtSoLuongSP.setText(String.valueOf(sp.getSoLuong()));
        txtGiaSP.setText(String.valueOf(sp.getGiaTien()));
        if (sp.getHinh() != null) {
            lblHinh.setIcon(XImage.readLogo(sp.getHinh()));
            /*
             ImageIcon readLogo(String tenFile) đọc file trong thư mục logos theo tên file trả về ImageIcon
             void setIcon(ImageIcon icon) set Icon cho lbl
             */
        } else {
            lblHinh.setIcon(XImage.readLogo("noImage.png"));
        }

    }

    private void updateStatusSP() {
        boolean edit = (this.row >= 0);
        boolean first = (this.row == 0);
        boolean last = (this.row == tblSP.getRowCount() - 1);

        txtMaSP1.setEditable(!edit);
        btnThemSP.setEnabled(!edit);
        btnSuaSP.setEnabled(edit);
        btnXoaSP.setEnabled(edit);

        btnFirtSP.setEnabled(edit && !first);
        btnPreSP.setEnabled(edit && !first);
        btnNexSP.setEnabled(edit && !last);
        btnLasSP.setEnabled(edit && !last);
    }

    private void insertSP() {
        if (!Auth.isManager()) {
            MsgBox.alert(this, "Bạn không có quyền thêm sản phẩm!");
        } else {
            SanPham sp = getFormSP();
            try {
                SpDao.insert(sp);
                this.filltableSP();
                this.clearFormSP();
                this.fillComboBoxHD();
                MsgBox.alert(this, "Thêm mới thành công");
            } catch (Exception e) {
                MsgBox.alert(this, "Thêm mới thất bại !");
            }
        }
    }

    private void updateSP() {
        if (!Auth.isManager()) {
            MsgBox.alert(this, "Bạn không có quyền sửa sản phẩm!");
        } else {
            SanPham sp = getFormSP();
            try {
                SpDao.update(sp);
                this.filltableSP();
                MsgBox.alert(this, "Update thành công ");
            } catch (Exception e) {
                MsgBox.alert(this, "Update thành công ");
            }
        }
    }

    private void deleteSP() {
        if (!Auth.isManager()) {
            MsgBox.alert(this, "Bạn không có quyền xóa sản phẩm!");
        } else {
            String masp = txtMaSP1.getText();
            if (MsgBox.confirm(this, "Bạn thực sự muốn xóa sản phẩm này ?")) {
                try {
                    SpDao.delete(masp);
                    this.filltableSP();
                    this.clearFormSP();
                    MsgBox.alert(this, "Xóa thành công ");
                } catch (Exception e) {
                    MsgBox.alert(this, "Xóa thất bại !");
                }
            }
        }
//        }
    }

    private void clearFormSP() {

        filltable();
        SanPham sp = (SanPham) cboMaSP.getSelectedItem();
        txtMaSP1.setText("");
        txtNhanHieuSP.setText((""));
        txtTenSP.setText("");
        txtMauSP.setText("");
        txtSoLuongSP.setText("");
        txtGiaSP.setText("");
        this.setFormSP(new SanPham());
        btnThemSP.setEnabled(true);
        btnXoaSP.setEnabled(false);
        btnSuaSP.setEnabled(false);
        txtMaSP1.setEditable(true);
    }

    private void FirtSP() {
        this.row = 0;
        this.editSP();
    }

    private void PrevSP() {
        if (this.row > 0) {
            this.row--;
            this.editSP();
        }
    }

    private void NextSP() {
        if (this.row < tblSP.getRowCount() - 1) {
            this.row++;
            this.editSP();
        }
    }

    private void LastSP() {
        this.row = tblSP.getRowCount() - 1;
        this.editSP();
    }

    void printSP() {
        FileOutputStream excelfou = null;
        BufferedOutputStream excelBOU = null;
        XSSFWorkbook exceljtableExporter = null;
        //chon noi luu file 
        JFileChooser excelfile = new JFileChooser("d:\\prinexcel");
        //Thanh tiu de
        excelfile.setDialogTitle("Save As");
        //cac dang ten duoi mo rong cua excel
        FileNameExtensionFilter fnef = new FileNameExtensionFilter("EXCEL FILES", "xls", "xlxs", "xlsm");
        excelfile.setFileFilter(fnef);
        int excelchoose = excelfile.showSaveDialog(null);

        //kiểm tra xem nút lưu có được nhấp không
        if (excelchoose == JFileChooser.APPROVE_OPTION) {
            try {
                //import thu vien apache poi excel
                exceljtableExporter = new XSSFWorkbook();
                XSSFSheet excelsheet = exceljtableExporter.createSheet("HoaDon");
                // vòng lặp để lấy cột và hàng của bảng
                for (int i = 0; i < modelSP.getRowCount(); i++) {
                    XSSFRow excelrow = excelsheet.createRow(i);
                    for (int j = 0; j < modelSP.getColumnCount(); j++) {
                        XSSFCell excelCell = excelrow.createCell(j);
                        excelCell.setCellValue(tblSP.getValueAt(i, j).toString());
                    }
                }
                //nối phần mở rộng tệp xlsx vào các tệp đã chọn. để tạo tên tệp duy nhất  
                excelfou = new FileOutputStream(excelfile.getSelectedFile() + ".xlsx");
                excelBOU = new BufferedOutputStream(excelfou);
                exceljtableExporter.write(excelBOU);
                JOptionPane.showMessageDialog(this, "Tạo và thêm thành công");
            } catch (FileNotFoundException ex) {
                ex.printStackTrace();
            } catch (IOException ex) {
                Logger.getLogger(FormChinh.class.getName()).log(Level.SEVERE, null, ex);
            } finally {
                try {
                    if (excelBOU != null) {
                        excelBOU.close();
                    }
                    if (excelfou != null) {
                        excelfou.close();
                    }
                    if (exceljtableExporter != null) {
                        exceljtableExporter.close();
                    }
                } catch (IOException ex) {
                    ex.printStackTrace();
                }
            }

        }
    }

    public boolean checkTrungMaSP(JTextField txt) {
        txt.setBackground(white);
        if (SpDao.selectById(txt.getText()) == null) {
            return true;
        } else {
            txt.setBackground(pink);
            MsgBox.alert(this, txt.getName() + " đã bị tồn tại.");
            return false;
        }
    }

    public boolean checkNullHinh() {
        if (lblHinh.getToolTipText() != null) {
            return true;
        } else {
            MsgBox.alert(this, "Không được để trống hình.");
            return false;
        }
    }
//------------------------------------------------------------------------------ DANG XUAT

    void dangXuat() {
        Auth.clear();
        if (MsgBox.confirm(this, "Bạn muốn đăng xuất ?")) {
            new DangNhapJDialog(this, true).setVisible(true);
        }
    }

//------------------------------------------------------------------------------ HOA DON
    HoaDonDAO hddao = new HoaDonDAO();

    void fillTableTimKiemHD() {
        DefaultTableModel model = (DefaultTableModel) tblHd.getModel();
        model.setRowCount(0);

        String keyword = txtTimKiemHD.getText();
        List<HoaDon> list = hddao.selectByKeywordHD(keyword);

        for (HoaDon hd : list) {
            model.addRow(new Object[]{
                hd.getMaHD(),
                hd.getMaSP(),
                hd.getSoLuong(),
                dateHelper.toString(hd.getNgayLapHD()),
                hd.getMaKH(),
                String.format("%.0f", hd.getThanhTien()),
                hd.getMaNV(),
                String.format("%.0f", hd.getGia())
            });

        }
    }
    DefaultTableModel modelhd;

    void filltablehd() {
        modelhd = (DefaultTableModel) tblHd.getModel();
        modelhd.setRowCount(0);
        try {
            List<HoaDon> listhd = hddao.selectAll();
            for (HoaDon hd : listhd) {
                Object[] row = {
                    hd.getMaHD(),
                    hd.getMaSP(),
                    hd.getSoLuong(),
                    dateHelper.toString(hd.getNgayLapHD()),
                    hd.getMaKH(),
                    String.format("%.0f", hd.getThanhTien()),
                    hd.getMaNV(),
                    String.format("%.0f", hd.getGia())
                };
                modelhd.addRow(row);
            }
        } catch (Exception e) {
            MsgBox.alert(this, "Lỗi truy vấn dữ liệu");
        }
    }

    private void editHD() {
        try {
            String MaHD = (String) tblHd.getValueAt(this.row, 0);
            HoaDon hd = hddao.selectById(MaHD);
            this.setformHD(hd);
            TabHoaDon.setSelectedIndex(0);
            this.updateStatusHD();
        } catch (Exception e) {
            System.out.println("edit:  " + e);
        }
    }

    HoaDon getformHD() {

        HoaDon hd = new HoaDon();
        hd.setMaHD(txtmahd.getText());
        SanPham sp = (SanPham) cboMaSP.getSelectedItem();
        hd.setMaSP(sp.getMaSP());
        hd.setSoLuong(new Integer(txtSoLuongHD.getText()));

        hd.setNgayLapHD(dateHelper.now());
        KhachHang kh = (KhachHang) cboMaKH.getSelectedItem();
        hd.setMaKH(kh.getMaKH());
        hd.setThanhTien(Double.valueOf(txtthanhtien.getText()));
        hd.setTrangThai(txttrangthai.getText());
        hd.setMaNV(Auth.user.getMaNV());
        return hd;
    }

    void setformHD(HoaDon hd) {
        txtmahd.setText(hd.getMaHD());
        cboMaSP.setToolTipText(String.valueOf(hd.getMaHD()));
        cboMaSP.getModel().setSelectedItem(SpDao.selectById(hd.getMaSP()));
        txtSoLuongHD.setText(String.valueOf(hd.getSoLuong()));
        cboMaKH.setToolTipText(String.valueOf(hd.getMaHD()));
        cboMaKH.getModel().setSelectedItem(khDao.selectById(hd.getMaKH()));
        txtthanhtien.setText(String.format("%.0f", hd.getThanhTien()));
        txttrangthai.setText(hd.getTrangThai());
        txtmanv_HD.setText(hd.getMaNV());
        txtNgayLapHD.setText(dateHelper.toString(hd.getNgayLapHD()));

    }

    void selectComboBoxKH() {
        KhachHang kh = (KhachHang) cboMaKH.getSelectedItem();
        //lấy 1 Object được chọn từ combobox
        //có thể điền và lấy 1 Object từ combobox

    }

    void selectComboBoxSP() {
        SanPham sp = (SanPham) cboMaSP.getSelectedItem();
        //lấy 1 Object được chọn từ combobox
        //có thể điền và lấy 1 Object từ combobox
        try {
            txtthanhtien.setText(Double.toString(sp.getGiaTien()));

        } catch (Exception e) {
        }

    }

    void fillComboBoxHD() {
        DefaultComboBoxModel model = (DefaultComboBoxModel) cboMaSP.getModel(); //kết nối model với cbo
        model.removeAllElements();   //xóa toàn bộ item của cbo
        try {
            List<SanPham> list = SpDao.selectAll();
            for (SanPham sp : list) {
                model.addElement(sp);    //thêm đối tượng (Object) vào model
                //chỉ thêm đc đối tượng đối với model, cbo chỉ được cbo.addItem(String);
                //lấy đối tượng thì từ cbo cũng được: cbo.getSelectedItem();
            }
        } catch (Exception e) {
            MsgBox.alert(this, "Lỗi truy vấn dữ liệu!");
        }
    }

    void fillComboBoxKH() {
        DefaultComboBoxModel model = (DefaultComboBoxModel) cboMaKH.getModel(); //kết nối model với cbo
        model.removeAllElements();   //xóa toàn bộ item của cbo
        try {
            List<KhachHang> list = khDao.selectAll();
            for (KhachHang kh : list) {
                model.addElement(kh);    //thêm đối tượng (Object) vào model
                //chỉ thêm đc đối tượng đối với model, cbo chỉ được cbo.addItem(String);
                //lấy đối tượng thì từ cbo cũng được: cbo.getSelectedItem();
            }
        } catch (Exception e) {
            MsgBox.alert(this, "Lỗi truy vấn dữ liệu!");
        }
    }

    private void clearformhd() {
        fillComboBoxHD();
        fillComboBoxKH();
        filltablehd();
        HoaDon hd = new HoaDon();
        hd.setNgayLapHD(dateHelper.now());
        hd.setMaNV(Auth.user.getMaNV());
        btnthemHD.setEnabled(true);
        txtmahd.setEditable(true);
        btnxoahd.setEnabled(false);
        btnsuahd.setEnabled(false);
        txtmahd.setText("");
        cboMaSP.setSelectedIndex(0);
        txtSoLuongHD.setText("");
        cboMaKH.setSelectedIndex(0);
        txtthanhtien.setText("");
        txttrangthai.setText("");
    }

    void inserthd() {
        if (!Auth.isLogin()) {
            MsgBox.alert(this, "Bạn cần đăng nhập!");
        } else {
        HoaDon model = getformHD();
        model.setNgayLapHD(dateHelper.now());

        hddao.insert(model);
        this.filltablehd();
        this.clearformhd();
        MsgBox.alert(this, "Thêm mới thành công!");
        }
    }

    private void updateStatusHD() {
        boolean edit = (this.row >= 0);
        boolean first = (this.row == 0);
        boolean last = (this.row == tblHd.getRowCount() - 1);

        txtmahd.setEditable(!edit);
        btnthemHD.setEnabled(!edit);
        btnsuahd.setEnabled(edit);
        btnxoahd.setEnabled(edit);

        btndauhd.setEnabled(edit && !first);
        btnluihd.setEnabled(edit && !first);
        btntoihd.setEnabled(edit && !last);
        btncuoihd.setEnabled(edit && !last);
    }

    void deletehd() {
        if (!Auth.isLogin()) {
            MsgBox.alert(this, "Bạn cần đăng nhập!");
        } else {
            String masp = txtmahd.getText();
            if (MsgBox.confirm(this, "Bạn thực sự muốn xóa sản phẩm này ?")) {
                try {
                    hddao.delete(masp);
                    this.filltablehd();
                    this.clearformhd();
                    MsgBox.alert(this, "Xóa thành công ");
                } catch (Exception e) {
                    MsgBox.alert(this, "Xóa thất bại !");
                }
            }
        }
    }

    void updatehd() {
        if (!Auth.isLogin()) {
            MsgBox.alert(this, "Bạn cần đăng nhập!");
        } else {
        HoaDon model = getformHD();

        try {
            hddao.update(model);
            this.filltablehd();
            MsgBox.alert(this, "Cập nhật thành công!");
        } catch (Exception e) {
            MsgBox.alert(this, "Cập nhật thất bại!");
        }}
    }

    private void dauhd() {
        this.row = 0;
        this.editHD();
    }

    private void luihd() {
        if (this.row > 0) {
            this.row--;
            this.editHD();
        }
    }

    private void toihd() {
        if (this.row < tblHd.getRowCount() - 1) {
            this.row++;
            this.editHD();
        }
    }

    private void cuoihd() {
        this.row = tblHd.getRowCount() - 1;
        this.editHD();
    }

    void printHD() {
        FileOutputStream excelfou = null;
        BufferedOutputStream excelBOU = null;
        XSSFWorkbook exceljtableExporter = null;
        //chon noi luu file 
        JFileChooser excelfile = new JFileChooser("d:\\prinexcel");
        //Thanh tiu de
        excelfile.setDialogTitle("Save As");
        //cac dang ten duoi mo rong cua excel
        FileNameExtensionFilter fnef = new FileNameExtensionFilter("EXCEL FILES", "xls", "xlxs", "xlsm");
        excelfile.setFileFilter(fnef);
        int excelchoose = excelfile.showSaveDialog(null);

        //kiểm tra xem nút lưu có được nhấp không
        if (excelchoose == JFileChooser.APPROVE_OPTION) {
            try {
                //import thu vien apache poi excel
                exceljtableExporter = new XSSFWorkbook();
                XSSFSheet excelsheet = exceljtableExporter.createSheet("HoaDon");
                // vòng lặp để lấy cột và hàng của bảng
                for (int i = 0; i < modelhd.getRowCount(); i++) {
                    XSSFRow excelrow = excelsheet.createRow(i);
                    for (int j = 0; j < modelhd.getColumnCount(); j++) {
                        XSSFCell excelCell = excelrow.createCell(j);
                        excelCell.setCellValue(tblHd.getValueAt(i, j).toString());
                    }
                }
                //nối phần mở rộng tệp xlsx vào các tệp đã chọn. để tạo tên tệp duy nhất  
                excelfou = new FileOutputStream(excelfile.getSelectedFile() + ".xlsx");
                excelBOU = new BufferedOutputStream(excelfou);
                exceljtableExporter.write(excelBOU);
                JOptionPane.showMessageDialog(this, "Tạo và thêm thành công");
            } catch (FileNotFoundException ex) {
                ex.printStackTrace();
            } catch (IOException ex) {
                Logger.getLogger(FormChinh.class.getName()).log(Level.SEVERE, null, ex);
            } finally {
                try {
                    if (excelBOU != null) {
                        excelBOU.close();
                    }
                    if (excelfou != null) {
                        excelfou.close();
                    }
                    if (exceljtableExporter != null) {
                        exceljtableExporter.close();
                    }
                } catch (IOException ex) {
                    ex.printStackTrace();
                }
            }

        }
    }

    public boolean checkTrungMaHD(JTextField txt) {
        txt.setBackground(white);
        if (hddao.selectById(txt.getText()) == null) {
            return true;
        } else {
            txt.setBackground(pink);
            MsgBox.alert(this, txt.getName() + " đã bị tồn tại.");
            return false;
        }
    }

}
